[TOC]

---

# WXWork-Tool

企业微信工具。

因为企微为了工作的原因，会设置自动下载文件，会导致本地缓存的文件较大。这里提供一些工具用于处理这些重复的文件（一开始人为删除，感觉比较麻烦，而且晃眼，于是想通过程序来处理）。

## 说明

**部分逻辑会直接删除文件，为防止误删，操作前请进行备份，数据无价**。

同时，涉及到删除操作的，不递归处理，目录写死，有需要的自定修改目录(`directory`)，防止误删数据。

注意：大部分只处理本地文件，不保证企微能够正常显示对于的聊天记录。（适用场景参考：离职后，想备份本地文件，但是发现很多重复的。）

## 图片相关工具 

图片路径：WXWork安装目录\企业id\Cache\Image

例如：D:\WXWork\1688850205828112\Cache\Image\2023-10

### 工具1：删除小于15kb的图片(把它当做是表情包)

据我观察，发现企微的表情包好像就是图片来的，也就是说和普通的文件很难区分。

因此，这里取巧了，我把这类很小的图片归结为表情包。

参考路径：D:\WXWork\1688850205828112\Cache\Image\2023-10

```shell
cd D:\WXWork\1688850205828112\Cache\Image\2023-10
sh 1_remove_emoji.sh
```

### 工具2：删除带括号的重复图片

图片重复的方式如下：

c0727119-53d8-415b-9f7a-d635c62817ba.jpg 
c0727119-53d8-415b-9f7a-d635c62817ba(1).jpg 重复

猜测成因：同一张照片，发到不同的聊天（不同人或者是不同的群），导致出现了重复。

**处理规则：**

1. 查找带括号的文件，是否同时存在去掉括号之后的文件。
2. 找到后，比较两个文件的大小，删除空间比较小的那个（其实偏向于删除有括号的文件）。

### 工具3：删除带png的重复图片jpg

原图是png，会重复生成一张jpg。图片重复方式如下：

```
企业微信截图_17131484238.png，989 KB
企业微信截图_17131484238.jpg，54.4KB
```

**处理规则：**

1. 查找png，是否同时存在同名的jpg。
2. 找到后，比较两个文件的大小，删除空间比较小的那个。

### 工具4

python 遍历目录下的文件：D:\WXWork\1688850205828112\Cache\Image\2023-11，如果是png，判断是否有同名的jpg图片，如有，打印jpg照片名称；如有类似(1)括号里面是数字这样的文件名，查找是否有类型的没有括号的文件名，如有，打印。

python 遍历目录下的文件：D:\WXWork\1688850205828112\Cache\Image\2023-11，如果是png，判断是否有同名的jpg图片，如有，打印jpg照片名称，并删除jpg图片；如有类似(1)括号里面是数字这样的文件名，查找是否有类型的没有括号的文件名，如有，打印带括号的文件名，并删除带括号的jpg图片。



